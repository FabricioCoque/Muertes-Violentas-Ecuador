--Creacion de Base de Datos 
CREATE DATABASE Registro_Oficial_Muertes;

--Creacion de Tablas
--Creacion de tabla Provincias en la cual sucedio el delito 

USE Registro_Oficial_Muertes;
CREATE TABLE Provincia (
	Id_Provincia INT IDENTITY(1,1) PRIMARY KEY,
	Provincia VARCHAR (100) NOT NULL
);
	
--Creacion de tabla Ciudad en la cual sucedio el delito 

CREATE TABLE Ciudad (
	Id_Ciudad INT IDENTITY(1,1) PRIMARY KEY,
	Ciudad VARCHAR(100) NOT NULL,
	Id_Provincia INT ,
	FOREIGN KEY (Id_Provincia) REFERENCES Provincia(Id_Provincia)
);

--Creacion de la Tabla Tipo de Arma Usada para el delito 

CREATE TABLE Arma (
	Id_Arma INT IDENTITY(1,1) PRIMARY KEY,
	Nombre_Tipo VARCHAR(100)
);

----Creacion de la Tabla que ofrece mas detalles sobre el arma usada 

CREATE TABLE Arma_Detalle(
	Id_Tipo INT IDENTITY (1,1) PRIMARY KEY ,
	Tipo_Arma VARCHAR(100) NOT NULL,
	Id_Arma INT ,
	FOREIGN KEY (Id_Arma) REFERENCES Arma(Id_Arma)
);

--Creacion de Tabla tipo delito 

CREATE TABLE Tipo_Delito(
	Id_Delito INT IDENTITY(1,1) PRIMARY KEY ,
	Delito VARCHAR(100)
);

--Creacion de Tabla Motivacion del Delito 

CREATE TABLE Presunto_Motivo (
	Id_Motivacion INT IDENTITY(1,1) PRIMARY KEY,
	Motivacion VARCHAR(100) 
);

--Creacmos la tabla que registra las Muertes Violentas

CREATE TABLE Registro_Muertes (
	Id_Registro INT PRIMARY KEY,
	Fecha DATE,
	Año INT,
	Mes VARCHAR(100),
	Id_Delito INT,
	Id_Ciudad INT,
	Id_Provincia INT,
	Id_Arma INT,
	Id_Motivacion INT,
	FOREIGN KEY (Id_Delito) REFERENCES Tipo_Delito(Id_Delito),
	FOREIGN KEY (Id_Ciudad) REFERENCES Ciudad (Id_Ciudad),
	FOREIGN KEY (Id_Provincia) REFERENCES Provincia (Id_Provincia),
	FOREIGN KEY (Id_Arma) REFERENCES Arma(Id_Arma),
	FOREIGN KEY (Id_Motivacion) REFERENCES  Presunto_Motivo (Id_Motivacion)
	);

--INSERTAMOS DATOS A LAS TABLAS 

INSERT INTO Arma(Nombre_Tipo)
VALUES 
	('ARMA DE FUEGO'),
	('ARMA BLANCA'),
	('ARMA CONTUNDENTE'),
	('CONSTRICTORA'),
	('OTROS'),
	('SUSTANCIAS')


INSERT INTO Arma_Detalle(Tipo_Arma,Id_Arma)
VALUES 
	('OTRO',1),
	('PISTOLA',1),
	('REVOLVER',1),
	('OTROS ARMA CORTA',1),
	('CORTO PUNZANTE',2),
	('CUCHILLO',2),
	('OBJETO CONTUSO',3),
	('CARTUCHERA',1),
	('SOGA',4),
	('NINGUNA',5),
	('SUBAMETRALLADORA',1),
	('ESCOPETA',1),
	('EXPLOSIVOS',5),
	('ROCA',3),
	('MACHETE',2),
	('FARMACOS',6),
	('PRENDA TEXTIL',4),
	('PALO',3),
	('GARROTE',3),
	('FUNDA',5),
	('ALCOHOL',6),
	('LANZA',2),
	('CARABINA',1),
	('SIN_DATO',1),
	('BARRA',3),
	('CORREA',4),
	('HIDROCARBUROS',5),
	('CINTA DE EMBALAJE',5),
	('DESTORNILLADOR',2),
	('NAVAJA',2),
	('VENENO',6),
	('ESCOPOLAMINA',6),
	('CABLE',4),
	('AMETRALLADORA',1),
	('MARTILLO',3),
	('CUERDA',4),
	('PUÑAL',2),
	('FUSIL',1),
	('NATURAL TÓXICA',6),
	('REPETIDORA',1),
	('AGROQUIMICO',6),
	('TIJERAS',2),
	('OTROS ARMA LARGA',1),
	('DROGAS ADICTIVAS',6),
	('PICA HIELO',2),
	('DAGA',2),
	('HOJA DE AFEITAR',2),
	('CADENA',4),
	('ELECTRICIDAD',5),
	('BATE',3),
	('ACIDOS',5),
	('BISTURI',2),
	('HACHA',2)

INSERT INTO  Tipo_Delito(Delito)
VALUES 
	('ASESINATO'),
	('HOMICIDIO'),
	('SICARIATO'),
	('FEMICIDIO')

INSERT INTO Provincia(Provincia)
VALUES
	('AZUAY'),
	('BOLIVAR'),
	('CARCHI'),
	('CAÑAR'),
	('CHIMBORAZO'),
	('COTOPAXI'),
	('EL ORO'),
	('ESMERALDAS'),
	('GALAPAGOS'),
	('GUAYAS'),
	('IMBABURA'),
	('LOJA'),
	('LOS RIOS'),
	('MANABI'),
	('MORONA SANTIAGO'),
	('NAPO'),
	('ORELLANA'),
	('PASTAZA'),
	('PICHINCHA'),
	('SANTA ELENA'),
	('SANTO DOMINGO DE LOS TSACHILAS'),
	('STO DGO DE LOS TSACHILAS'),
	('SUCUMBIOS'),
	('TUNGURAHUA'),
	('ZAMORA CHINCHIPE'),
	('ZONA NO DELIMITADA')

INSERT INTO Ciudad(Ciudad,Id_Provincia)
VALUES 
	('24 DE MAYO',14),
	('AGUARICO',17),
	('ALAUSI',5),
	('ALFREDO BAQUERIZO MORENO',10),
	('AMBATO',24),
	('ANTONIO ANTE',11),
	('ARAJUNO',18),
	('ARCHIDONA',16),
	('ARENILLAS',7),
	('ATACAMES',8),
	('ATAHUALPA',7),
	('AZOGUES',4),
	('BABA',13),
	('BABAHOYO',13),
	('BALAO',10),
	('BALSAS',7),
	('BALZAR',10),
	('BAÑOS DE AGUA SANTA',24),
	('BIBLIAN',4),
	('BOLIVAR',14),
	('BUENA FE',13),
	('CALUMA',2),
	('CALVAS',12),
	('CAMILO PONCE ENRIQUEZ',1),
	('CARLOS JULIO AROSEMENA TOLA',16),
	('CASCALES',23),
	('CATAMAYO',12),
	('CAYAMBE',19),
	('CAÑAR',4),
	('CELICA',12),
	('CENTINELA DEL CONDOR',25),
	('CEVALLOS',24),
	('CHAGUARPAMBA',12),
	('CHAMBO',5),
	('CHILLA',7),
	('CHILLANES',2),
	('CHIMBO',2),
	('CHINCHIPE',25),
	('CHONE',14),
	('CHORDELEG',1),
	('CHUNCHI',5),
	('COLIMES',10),
	('COLTA',5),
	('COTACACHI',11),
	('CRNEL. MARCELINO MARIDUEÑA',10),
	('CUENCA',1),
	('CUMANDA',5),
	('CUYABENO',23),
	('DAULE',10),
	('DELEG',4),
	('DURAN',10),
	('ECHEANDIA',2),
	('EL CARMEN',14),
	('EL CHACO',16),
	('EL GUABO',7),
	('EL PAN',1),
	('EL PANGUI',25),
	('EL TAMBO',4),
	('EL TRIUNFO',10),
	('ELOY ALFARO',8),
	('EMPALME',10),
	('ESMERALDAS',8),
	('ESPEJO',3),
	('ESPINDOLA',12),
	('FLAVIO ALFARO',14),
	('GIRON',1),
	('GNRAL. ANTONIO ELIZALDE',10),
	('GONZALO PIZARRO',23),
	('GONZANAMA',12),
	('GUACHAPALA',1),
	('GUALACEO',1),
	('GUALAQUIZA',15),
	('GUAMOTE',5),
	('GUANO',5),
	('GUARANDA',2),
	('GUAYAQUIL',10),
	('HUAMBOYA',15),
	('HUAQUILLAS',7),
	('IBARRA',11),
	('ISIDRO AYORA',10),
	('JAMA',14),
	('JARAMIJO',14),
	('JIPIJAPA',14),
	('JUNIN',14),
	('LA CONCORDIA',22),
	('LA JOYA DE LOS SACHAS',17),
	('LA LIBERTAD',20),
	('LA MANA',6),
	('LA TRONCAL',4),
	('LAGO AGRIO',23),
	('LAS LAJAS',7),
	('LAS NAVES',2),
	('LATACUNGA',6),
	('LIMON INDANZA',15),
	('LOGROÑO',15),
	('LOJA',12),
	('LOMAS DE SARGENTILLO',10),
	('LORETO',17),
	('MACARA',12),
	('MACHALA',7),
	('MANTA',14),
	('MEJIA',19),
	('MERA',18),
	('MILAGRO',10),
	('MIRA',3),
	('MOCACHE',13),
	('MOCHA',24),
	('MONTALVO',13),
	('MONTECRISTI',14),
	('MONTUFAR',3),
	('MORONA',15),
	('MUISNE',8),
	('NABON',1),
	('NANGARITZA',25),
	('NARANJAL',10),
	('NARANJITO',10),
	('NOBOL',10),
	('OLMEDO',14),
	('ORELLANA',17),
	('OTAVALO',11),
	('PABLO SEXTO',15),
	('PAJAN',14),
	('PALANDA',25),
	('PALENQUE',13),
	('PALESTINA',10),
	('PALLATANGA',5),
	('PALORA',15),
	('PALTAS',12),
	('PANGUA',6),
	('PAQUISHA',25),
	('PASAJE',7),
	('PASTAZA',18),
	('PATATE',24),
	('PAUTE',1),
	('PEDERNALES',14),
	('PEDRO CARBO',10),
	('PEDRO MONCAYO',19),
	('PEDRO VICENTE MALDONADO',19),
	('PICHINCHA',14),
	('PIMAMPIRO',11),
	('PINDAL',12),
	('PIÑAS',7),
	('PLAYAS',10),
	('PORTOVELO',7),
	('PORTOVIEJO',14),
	('PUCARA',1),
	('PUEBLO VIEJO',13),
	('PUEBLOVIEJO',13),
	('PUERTO FRANCISCO DE ORELLANA',17),
	('PUERTO LOPEZ',14),
	('PUERTO QUITO',19),
	('PUJILI',6),
	('PUTUMAYO',23),
	('PUYANGO',12),
	('QUERO',24),
	('QUEVEDO',13),
	('QUIJOS',16),
	('QUILANGA',12),
	('QUININDE',8),
	('QUINSALOMA',13),
	('QUITO',19),
	('RIOBAMBA',5),
	('RIOVERDE',8),
	('ROCAFUERTE',14),
	('RUMIÑAHUI',19),
	('SALCEDO',6),
	('SALINAS',20),
	('SALITRE',10),
	('SAMBORONDON',10),
	('SAN FERNANDO',1),
	('SAN JACINTO DE YAGUACHI',10),
	('SAN JUAN BOSCO',15),
	('SAN LORENZO',8),
	('SAN MIGUEL',2),
	('SAN MIGUEL DE  BOLIVAR',2),
	('SAN MIGUEL DE LOS BANCOS',19),
	('SAN MIGUEL DE SALCEDO',6),
	('SAN MIGUEL DE URCUQUI',11),
	('SAN PEDRO DE HUACA',3),
	('SAN PEDRO DE PELILEO',24),
	('SAN VICENTE',14),
	('SANTA ANA',14),
	('SANTA CLARA',18),
	('SANTA CRUZ',9),
	('SANTA ELENA',20),
	('SANTA ISABEL',1),
	('SANTA LUCIA',10),
	('SANTA ROSA',7),
	('SANTIAGO',15),
	('SANTIAGO DE PILLARO',24),
	('SANTO DOMINGO',22),
	('SAQUISILI',6),
	('SARAGURO',12),
	('SEVILLA DE ORO',1),
	('SHUSHUFINDI',23),
	('SIGCHOS',6),
	('SIGSIG',1),
	('SIMON BOLIVAR',10),
	('SOZORANGA',12),
	('SUCRE',14),
	('SUCUA',15),
	('SUCUMBIOS',23),
	('SUSCAL',4),
	('TAISHA',15),
	('TENA',16),
	('TISALEO',24),
	('TIWINTZA',15),
	('TOSAGUA',14),
	('TULCAN',3),
	('URDANETA',13),
	('VALENCIA',13),
	('VENTANAS',13),
	('VINCES',13),
	('YANTZAZA',25),
	('ZAMORA',25),
	('ZAPOTILLO',12),
	('ZARUMA',7),
	('ZONA NO DELIMITADA',26)

INSERT INTO Presunto_Motivo(Motivacion)
VALUES
	('VIOLENCIA COMUNITARIA'),
	('DELINCUENCIA COMUN'),
	('VIOLENCIA INTRAFAMILIAR'),
	('VIOLENCIA SEXUAL'),
	('TRANSNACIONAL'),
	('NO DETERMINADA'),
	('SICOPATOLOGIAS'),
	('TERRORISMO')


--CARGAMOS LOS DATOS DESDE UN ARCHIVO CSV A LA TABLA QUE REGISTRA TODAS LAS MUERTES DEL PERIODO 2014-2024
BULK INSERT Registro_Muertes
FROM 'C:\Users\HP\Documents\1.Fabricio Coque\16.Proyectos\2.SQL\Registro de Muertes Violentas\Registro_Muertes.csv'
WITH
(
	FIELDTERMINATOR = ';',
	ROWTERMINATOR ='\n',
	FIRSTROW=2
)
